<UserControl x:Class="POS_display.wpf.View.display2.Prices"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:POS_display.wpf.View.display2"
             xmlns:wpf="clr-namespace:POS_display.wpf"
             xmlns:fa="http://schemas.fontawesome.io/icons/"
             mc:Ignorable="d" 
             Focusable="True"
             Loaded="UserControl_Loaded"
             d:DesignHeight="530" d:DesignWidth="874">
    <UserControl.Resources>
        <ResourceDictionary>
            <FrameworkElement x:Key="ProxyElement" DataContext="{Binding}" />
            <wpf:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
            <wpf:BoolToStarConverter x:Key="BoolToStarConverter"/>
            <wpf:BoolToCheapestConverter x:Key="BoolToCheapestConverter"/>
            <wpf:BusyToCursorConverter x:Key="BusyToCursorConverter"/>
        </ResourceDictionary>
    </UserControl.Resources>
    <UserControl.Cursor>
        <Binding Path="DataContext.IsBusy" RelativeSource="{RelativeSource Self}" Converter="{StaticResource BusyToCursorConverter}"/>
    </UserControl.Cursor>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid Grid.Row="0" Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Label Grid.Row="0" Grid.Column="0" Content="{Binding model.lblName}" Foreground="#FF002664"/>
            <DockPanel Grid.Row="0" Grid.Column="1" HorizontalAlignment="Left" Width="620">
                <TextBox x:Name="ActiveSubstance" Text="{Binding GenericName}" IsReadOnly="True" DockPanel.Dock="Left" Width="570"/>
                <Button x:Name="ActiveSubstanceSearch" Grid.Column="1" Width="30" Height="30" Click="OpenDialogButton_Click"
                    Background="Transparent" 
                    BorderBrush="Transparent" 
                    BorderThickness="0" 
                    Padding="0" 
                    Margin="0" Visibility="{Binding SeparateActiveSubstancesMode, Converter={StaticResource BoolToVisibilityConverter}}">
                    <fa:ImageAwesome Icon="Search" />
                </Button>
            </DockPanel>
            <Label Grid.Row="1" Grid.Column="0" Content="{Binding model.lblCompensationPercent}" Foreground="#FF002664"/>
            <TextBox Grid.Row="1" Grid.Column="1" Width="620" HorizontalAlignment="Left" Text="{Binding model.Percentage}" IsReadOnly="True"/>
            <Label Grid.Row="2" Grid.Column="0" Content="{Binding model.lblFormOfUse}" Foreground="#FF002664"/>
            <TextBox x:Name = "PharmaceuticalFormLabel" Grid.Row="2" Grid.Column="1" Text="{Binding FormOfUse}"/>
            <ComboBox x:Name = "PharmaceuticalForm" ItemsSource="{Binding PharmaceuticalForms}" SelectedItem="{Binding FormOfUse,  UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" IsEnabled="{Binding CanEditFormOfUse}" HorizontalAlignment = "Left" VerticalAlignment = "Top"  Grid.Row="2" Grid.Column="1" Width="620"/>
            <Label Grid.Row="3" Grid.Column="0" Content="{Binding model.lblAmount}" Foreground="#FF002664"/>
            <TextBox x:Name="Dosage" Grid.Row="3" Grid.Column="1" Width="620" HorizontalAlignment="Left" Text="{Binding Dosage, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
            <Label Grid.Row="4" Grid.Column="0" Content="{Binding model.lblStrength}" Foreground="#FF002664"/>
            <TextBox x:Name = "StrengthValueLabel" Grid.Row="4" Grid.Column="1" Text="{Binding Strength}"/>
            <ComboBox x:Name = "Strength" Grid.Row="4" ItemsSource="{Binding Strengths}" SelectedItem="{Binding Strength,  UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" IsEnabled="{Binding CanEditStrength}" HorizontalAlignment = "Left" VerticalAlignment = "Top"  Grid.Column="1" Width="620"/>
            <Separator Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2" Height="20" Foreground="#FF58A618"/>
        </Grid>
        <Grid Grid.Row="1" Grid.Column="0">
            <fa:ImageAwesome x:Name="Loader" Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibilityConverter}}" Icon="Spinner" Spin="True" Height="48" Width="48" />
            <TextBlock x:Name="CurrentBalanceQtyVisible" Tag="True"/>
            <ContentControl Content="{StaticResource ProxyElement}" Visibility="Collapsed" />
            <DataGrid x:Name="DG" ItemsSource="{Binding gvPricesItemsSource, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                      AlternationCount="{Binding alternationCount}" 
                      SelectedItem="{Binding gvPricesSelectedRow}" 
                      SelectedIndex="{Binding gvPricesSelectedIndex}" Margin="0,0,0,40">
                <DataGrid.InputBindings>
                    <MouseBinding MouseAction="LeftDoubleClick"
                        Command="{Binding DoubleClickCommand}"/>
                    <KeyBinding Key="Return" 
                        Command="{Binding DoubleClickCommand}"/>
                </DataGrid.InputBindings>
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding IsCheapest, Converter={StaticResource BoolToCheapestConverter}}" Width="50" Header=""/>
                    <DataGridTextColumn x:Name="GIColumn" Binding="{Binding IsMaxGIChain, Converter={StaticResource BoolToStarConverter}}" Width="10" Header="" Visibility="{Binding DataContext.model.GIVisible, Converter={StaticResource BoolToVisibilityConverter}, Source={StaticResource ProxyElement}}"/>
                    <DataGridTextColumn Binding="{Binding ShortName}" Width="*" Header="{Binding DataContext.model.ShortNameHeader, Source={StaticResource ProxyElement}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.TextWrapping" Value="Wrap" />
                                <Setter Property="TextBlock.TextAlignment" Value="Left"/>
                                <Setter Property="TextBlock.Cursor" Value="Hand"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Binding="{Binding qtyVKBPrice}" Width="200" Header="{Binding DataContext.model.VKBPriceHeader, Source={StaticResource ProxyElement}}" Visibility="{Binding DataContext.model.VKBPriceVisible, Converter={StaticResource BoolToVisibilityConverter}, Source={StaticResource ProxyElement}}"/>
                    <DataGridTextColumn Binding="{Binding CompensatedPrice}" Width="110" Header="{Binding DataContext.model.CompensatedPriceHeader, Source={StaticResource ProxyElement}}"/>
                    <DataGridTextColumn x:Name="QtyColumn" Binding="{Binding CurrentBalanceQty}" Width="100" Header="Likutis vaistinėje" Visibility="{Binding DataContext.model.PharmacyQtyVisible, Converter={StaticResource BoolToVisibilityConverter}, Source={StaticResource ProxyElement}}"/>
                    <DataGridTextColumn x:Name="TamroQtyColumn" Binding="{Binding CurrentTamroQty}" Width="100" Header="Tamro likutis" Visibility="{Binding DataContext.model.TamroQtyVisible, Converter={StaticResource BoolToVisibilityConverter}, Source={StaticResource ProxyElement}}"/>
                    <DataGridTextColumn x:Name="Oficina" Binding="{Binding OficinaLocation}" Width="40" Header="V1"/>
                    <DataGridTextColumn x:Name="Oficina_2" Binding="{Binding Oficina2Location}" Width="40" Header="V2"/>
                    <DataGridTextColumn x:Name="Stock" Binding="{Binding StockLocation}" Width="40" Header="V3"/>
                    <DataGridTemplateColumn x:Name="NonTamroButton">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="@" Command="{Binding Path=DataContext.NonTamroCommand, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" BorderBrush="Transparent"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Grid>
</UserControl>